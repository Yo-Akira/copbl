

---

# 多智能体 Blockly 项目文档

## 项目概述

该项目旨在构建一个基于 Blockly 和 Vue.js 的智能体构建与交互平台，用户可以通过拖拽积木来搭建智能体的工作流、定义输入输出、并与生成的智能体进行对话。每个智能体都可以由用户自定义，并通过输入框与系统交互，完成特定任务。

### 功能亮点：

* **智能体创建与管理**：用户可以创建多个智能体，并为每个智能体设置不同的工作流和系统提示。
* **Blockly 工作流设计**：通过 Blockly 编辑器可视化搭建工作流，用户可以拖拽积木并生成对应的 JavaScript 代码。
* **智能体与用户对话**：系统支持与智能体的连续对话，用户发送消息后，智能体根据工作流生成相应的响应。
* **保存与加载智能体**：用户可以保存已创建的智能体，并在系统重启后加载这些智能体进行编辑或使用。

## 核心技术

1. **Vue.js**：用于构建前端 UI 和组件化管理，响应式设计。
2. **Blockly**：用于可视化拖拽编辑智能体工作流。
3. **OpenAI GPT-3/4**：用于处理自然语言输入，通过调用 OpenAI API，生成基于用户输入的智能体响应。
4. **localStorage**：用于保存智能体的数据，使得即使关闭或刷新页面后，用户的智能体配置和数据仍然能够保持。

## 主要功能模块

### 1. **AgentManager**

* **功能**：管理智能体的创建、选择、保存等功能。
* **工作流程**：用户可以创建新智能体、选择现有智能体，系统会更新相应的工作区。

### 2. **BlocklyWorkspace**

* **功能**：用户可通过拖拽积木来创建智能体的工作流，并自动生成对应的 JavaScript 代码。
* **工作流程**：用户通过拖拽积木来搭建输入输出节点、任务逻辑等，每次积木变化都会实时更新代码。

### 3. **Preview**

* **功能**：显示与智能体的对话界面，用户可以与当前选中的智能体进行对话和调试。
* **工作流程**：每次用户输入消息，智能体会根据工作流生成相应的反馈，交互过程连贯。点击“保存智能体”后，智能体的状态会被保存。

### 4. **代码生成与执行**

* **功能**：生成智能体对应的 JavaScript 代码，并通过 `eval()` 执行。
* **工作流程**：每次用户编辑工作流，代码会实时更新。点击“运行”按钮后，执行用户的输入并显示响应。

## 交互逻辑

1. **创建智能体**：

   * 用户点击“创建智能体”，并输入智能体的名称和系统提示。
   * 系统会生成一个空白的工作流区域，并为该智能体分配一个唯一 ID。

2. **设计工作流**：

   * 用户通过拖拽 Blockly 积木，搭建智能体的工作流。
   * 系统会实时生成对应的 JavaScript 代码，显示在右侧代码区域。

3. **与智能体对话**：

   * 用户通过输入框与智能体进行对话。
   * 智能体会根据用户输入的内容，调用已定义的工作流进行处理并返回响应。

4. **保存与加载智能体**：

   * 用户可以点击“保存智能体”按钮，将当前智能体的状态保存在 `localStorage` 中。
   * 系统启动时，会从 `localStorage` 中加载已保存的智能体，用户可以选择编辑或继续使用。

## 代码结构

* **App.vue**：主容器组件，管理左侧的智能体列表与 Blockly 工作区，右侧显示代码与对话界面。
* **AgentManager.vue**：智能体管理组件，负责显示智能体列表及其操作（创建、删除、选择）。
* **BlocklyWorkspace.vue**：Blockly 工作区组件，允许用户通过拖拽积木搭建工作流，并生成 JavaScript 代码。
* **Preview\.vue**：聊天界面组件，用户可以与选中的智能体进行对话调试。
* **ai.js**：包含与 OpenAI 交互的 API，处理文本输入、图像分析、网页搜索等功能。

## 已知问题与改进

1. **代码执行安全性**：

   * 目前使用 `eval()` 执行生成的 JavaScript 代码，存在一定的安全风险。未来可以考虑引入沙箱技术或替代方案（如 Web Worker 或 iframe）来增强安全性。

2. **智能体会话问题**：

   * 当前每次用户发送消息时，系统重新生成新的会话。需要进一步优化为在已有会话的基础上继续对话，而不是每次都重新开始。

3. **UI 改进**：

   * 目前界面简单，后期可以增加更多的用户交互提示和智能体调试功能，比如对话历史、AI 状态监控等。

## 安装与运行

1. 克隆项目到本地：

   ```bash
   git clone https://your-repository-url
   cd your-project-directory
   ```

2. 安装依赖：

   ```bash
   npm install
   ```

3. 启动开发服务器：

   ```bash
   npm run dev
   ```

4. 打开浏览器，访问 `http://localhost:5173` 即可查看项目。

---

这个文档为你总结了项目的主要功能与技术架构，便于你以后整理与回顾，也能帮助团队成员理解系统架构与模块关系。
